<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Proyecto VR con Meta Quest 2</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  </head>
  <body>

    <!-- Comportamiento del movimiento de la camara con El joystick -->

    <a-entity id="cameraRig" position="0 1.6 0">
      <a-camera wasd-controls="acceleration: 100" look-controls="pointerLockEnabled: true"></a-camera>
    </a-entity>


    <!-- Un suelo para que sea visible el movimiento -->
    <a-plane position="0 0 0" rotation="-90 0 0" width="20" height="20" color="#7BC8A4"></a-plane>



    <a-scene>
        <!-- Objeto interactivo con clase "clickable" -->
      
        <!-- Controlador de la mano derecha con raycaster para detectar objetos "clickable" -->
        <a-entity id="mano-derecha" hand-controls="hand: right"
                  raycaster="objects: .clickable"
                  grabber></a-entity>
      
        <a-sky color="#000000"></a-sky>

      </a-scene>






      <!-- CONTROLES DE ILUMINCAION -->
      <a-scene>
        <a-light type="ambient" color="#ffffff" intensity="0.5"></a-light>
        <a-light type="directional" position="2 4 -3" intensity="1"></a-light>
      
        <!-- Suelo visible -->
        <a-plane position="0 0 0" rotation="-90 0 0" width="20" height="20" color="#7BC8A4"></a-plane>
      
        <!-- Objetos adicionales -->
        <a-box position="0 0.5 -3" depth="1" height="1" width="1" color="#4CC3D9" class="clickable"></a-box>
        <a-sphere position="2 1 -5" radius="1" color="#EF2D5E" class="clickable"></a-sphere>
        <a-cylinder position="-3 0.75 -6" radius="0.5" height="1.5" color="#FFC65D" class="clickable"></a-cylinder>
      </a-scene>
      


      <script>
        // Componente para "agarrar" un objeto
        AFRAME.registerComponent('grabber', {
          init: function () {
            const handEl = this.el;
            let heldObject = null;
      
            // Detectar cuando el trigger es presionado sobre un objeto "clickable"
            handEl.addEventListener('triggerdown', () => {
              const intersectedEls = handEl.components.raycaster.intersectedEls;
              if (intersectedEls.length > 0) {
                heldObject = intersectedEls[0]; // Toma el primer objeto intersectado
                heldObject.setAttribute('position', handEl.getAttribute('position'));
                handEl.appendChild(heldObject); // Adjunta el objeto al controlador
              }
            });
      
            // Suelta el objeto al liberar el trigger
            handEl.addEventListener('triggerup', () => {
              if (heldObject) {
                handEl.sceneEl.appendChild(heldObject); // Suelta el objeto de la mano
                heldObject = null;
              }
            });
          }
        });
      </script>
      
  </body>
</html>
